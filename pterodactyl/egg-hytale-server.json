{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY - https://github.com/sanasol/hytale-server-docker",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2026-01-30T00:00:00+00:00",
    "name": "Hytale Server",
    "author": "sanasol@sanasol.ws",
    "description": "Hytale game server with automatic download and auto-update. No Hytale account required. Supports both F2P and official licensed clients.",
    "features": null,
    "docker_images": {
        "Java 21": "ghcr.io/pterodactyl/yolks:java_21"
    },
    "file_denylist": [],
    "startup": "./start.sh",
    "config": {
        "files": "{}",
        "startup": "{\r\n    \"done\": \"Server fully started\"\r\n}",
        "logs": "{}",
        "stop": "stop"
    },
    "scripts": {
        "installation": {
            "script": "#!/bin/bash\n# Hytale F2P Server Installation Script\n# Downloads pre-patched server from F2P host - no official auth required\n\necho \"=== Hytale F2P Server Installation ===\"\necho \"Downloads server from F2P host (no official auth required)\"\necho \"\"\n\n# Install required packages\necho \"Installing required packages...\"\napt-get update\napt-get install -y unzip curl default-jdk\n\n# Configuration\nAUTH_DOMAIN=\"${AUTH_DOMAIN:-auth.sanasol.ws}\"\nF2P_DOWNLOAD_BASE=\"${F2P_DOWNLOAD_BASE:-https://download.sanasol.ws/download}\"\nINJECTED_CLASS=\"com/hypixel/hytale/server/core/auth/DualAuthContext.class\"\nVERSION_DIR=\".hytale-versions\"\n\ncd /mnt/server\nmkdir -p \"$VERSION_DIR\"\n\n# ========================================\n# Step 0: Create start.sh with auto-update\n# ========================================\necho \"\"\necho \"=== Step 0: Creating start script ===\"\n\ncat > start.sh << 'STARTSCRIPT'\n#!/bin/bash\n# Hytale F2P Server Start Script with Auto-Update\nset -e\n\necho \"==========================================\"\necho \"  Hytale F2P Server\"\necho \"==========================================\"\necho \"\"\n\n# Configuration\nAUTH_DOMAIN=\"${AUTH_DOMAIN:-auth.sanasol.ws}\"\nF2P_DOWNLOAD_BASE=\"${F2P_DOWNLOAD_BASE:-https://download.sanasol.ws/download}\"\nAUTO_UPDATE=\"${AUTO_UPDATE:-1}\"\nHYTALE_PORT=\"${SERVER_PORT:-${HYTALE_PORT:-5520}}\"\nMEMORY_OVERHEAD=\"${MEMORY_OVERHEAD:-256}\"\nAUTH_MODE=\"${AUTH_MODE:-authenticated}\"\nJVM_ARGS=\"${JVM_ARGS:-}\"\nVERSION_DIR=\".hytale-versions\"\nINJECTED_CLASS=\"com/hypixel/hytale/server/core/auth/DualAuthContext.class\"\n\nmkdir -p \"$VERSION_DIR\"\n\n# ========================================\n# Auto-Update Check\n# ========================================\nget_remote_version() {\n    local url=\"$1\"\n    local headers=$(curl -sI -L \"$url\" 2>/dev/null | tr -d '\\r')\n    local etag=$(echo \"$headers\" | grep -i \"^etag:\" | tail -1 | sed 's/^[^:]*: *//' | tr -d '\"')\n    if [ -n \"$etag\" ]; then\n        echo \"$etag\"\n        return 0\n    fi\n    local lastmod=$(echo \"$headers\" | grep -i \"^last-modified:\" | tail -1 | sed 's/^[^:]*: *//')\n    if [ -n \"$lastmod\" ]; then\n        echo \"$lastmod\"\n        return 0\n    fi\n    local length=$(echo \"$headers\" | grep -i \"^content-length:\" | tail -1 | sed 's/^[^:]*: *//')\n    if [ -n \"$length\" ]; then\n        echo \"size:$length\"\n        return 0\n    fi\n    return 1\n}\n\ncheck_and_update() {\n    local url=\"$1\"\n    local dest=\"$2\"\n    local name=\"$3\"\n    local expected_mb=\"$4\"\n    local version_file=\"$VERSION_DIR/${name}.version\"\n    \n    if [ ! -f \"$dest\" ]; then\n        echo \"[UPDATE] $name not found, downloading...\"\n        download_file \"$url\" \"$dest\" \"$name\" \"$expected_mb\"\n        return $?\n    fi\n    \n    if [ \"$AUTO_UPDATE\" != \"1\" ]; then\n        echo \"[UPDATE] $name exists, auto-update disabled\"\n        return 0\n    fi\n    \n    local remote_version=$(get_remote_version \"$url\" 2>/dev/null) || true\n    if [ -z \"$remote_version\" ]; then\n        echo \"[UPDATE] Could not check remote version for $name\"\n        return 0\n    fi\n    \n    local local_version=\"\"\n    if [ -f \"$version_file\" ]; then\n        local_version=$(cat \"$version_file\" 2>/dev/null) || true\n    fi\n    \n    if [ \"$remote_version\" = \"$local_version\" ]; then\n        echo \"[UPDATE] $name is up-to-date\"\n        return 0\n    fi\n    \n    echo \"[UPDATE] $name has update available!\"\n    if [ -n \"$local_version\" ]; then\n        echo \"[UPDATE]   Current: $local_version\"\n    fi\n    echo \"[UPDATE]   Remote:  $remote_version\"\n    echo \"[UPDATE] Downloading update...\"\n    \n    if download_file \"$url\" \"$dest\" \"$name\" \"$expected_mb\"; then\n        echo \"$remote_version\" > \"$version_file\"\n        # Clear patch flag for JAR updates\n        if [ \"$name\" = \"HytaleServer.jar\" ]; then\n            rm -f .patched_dual_auth 2>/dev/null || true\n        fi\n        return 0\n    fi\n    return 1\n}\n\ndownload_file() {\n    local url=\"$1\"\n    local dest=\"$2\"\n    local name=\"$3\"\n    local expected_mb=\"$4\"\n    \n    echo \"Downloading $name...\"\n    for attempt in 1 2 3; do\n        if curl -fL -# -o \"${dest}.tmp\" \"$url\" 2>&1; then\n            mv \"${dest}.tmp\" \"$dest\"\n            local size=$(stat -c%s \"$dest\" 2>/dev/null || stat -f%z \"$dest\" 2>/dev/null || echo 0)\n            local mb=$((size / 1024 / 1024))\n            echo \"$name downloaded (${mb} MB)\"\n            return 0\n        fi\n        echo \"Attempt $attempt failed, retrying...\"\n        rm -f \"${dest}.tmp\"\n        sleep 2\n    done\n    echo \"ERROR: Failed to download $name\"\n    return 1\n}\n\necho \"Checking for updates...\"\ncheck_and_update \"${F2P_DOWNLOAD_BASE}/HytaleServer.jar\" \"HytaleServer.jar\" \"HytaleServer.jar\" \"80\"\ncheck_and_update \"${F2P_DOWNLOAD_BASE}/Assets.zip\" \"Assets.zip\" \"Assets.zip\" \"3300\"\n\n# Verify DualAuth patch\nif [ -f \"HytaleServer.jar\" ]; then\n    if ! unzip -l HytaleServer.jar 2>/dev/null | grep -q \"$INJECTED_CLASS\"; then\n        echo \"WARNING: DualAuth classes not found in JAR!\"\n    fi\nfi\necho \"\"\n\necho \"DUAL AUTHENTICATION SUPPORTED:\"\necho \"  - F2P clients: Connect directly (no setup needed)\"\necho \"  - Official clients: Admin runs in SERVER CONSOLE:\"\necho \"      /auth logout\"\necho \"      /auth persistence Encrypted\"\necho \"      /auth login device\"\necho \"\"\n\n# Calculate heap size\nSERVER_MEM=${SERVER_MEMORY:-0}\nif [ \"$SERVER_MEM\" -le 0 ] 2>/dev/null || [ -z \"$SERVER_MEM\" ]; then\n    if [ -f /sys/fs/cgroup/memory.max ]; then\n        CGROUP_MEM=$(cat /sys/fs/cgroup/memory.max 2>/dev/null)\n        if [ \"$CGROUP_MEM\" != \"max\" ] && [ -n \"$CGROUP_MEM\" ]; then\n            SERVER_MEM=$((CGROUP_MEM / 1024 / 1024))\n        fi\n    elif [ -f /sys/fs/cgroup/memory/memory.limit_in_bytes ]; then\n        CGROUP_MEM=$(cat /sys/fs/cgroup/memory/memory.limit_in_bytes 2>/dev/null)\n        if [ \"$CGROUP_MEM\" -lt 9223372036854771712 ] 2>/dev/null; then\n            SERVER_MEM=$((CGROUP_MEM / 1024 / 1024))\n        fi\n    fi\n    if [ \"$SERVER_MEM\" -le 0 ] 2>/dev/null; then\n        SERVER_MEM=$(free -m 2>/dev/null | awk '/^Mem:/{print $2}')\n        SERVER_MEM=$((SERVER_MEM * 80 / 100))\n    fi\n    if [ \"$SERVER_MEM\" -le 0 ] 2>/dev/null; then\n        SERVER_MEM=4096\n    fi\nfi\nHEAP_SIZE=$((SERVER_MEM - MEMORY_OVERHEAD))\nif [ $HEAP_SIZE -lt 1024 ]; then\n    HEAP_SIZE=1024\nfi\n\necho \"Server Port: $HYTALE_PORT (UDP)\"\necho \"Auth Mode: $AUTH_MODE\"\necho \"Memory: ${HEAP_SIZE}M\"\necho \"\"\n\n# Check required files\nif [ ! -f \"HytaleServer.jar\" ]; then\n    echo \"ERROR: HytaleServer.jar not found!\"\n    exit 1\nfi\nif [ ! -f \"Assets.zip\" ]; then\n    echo \"ERROR: Assets.zip not found!\"\n    exit 1\nfi\n\necho \"Starting server...\"\n\n# Build Java command\nJAVA_CMD=\"java -Xms${HEAP_SIZE}M -Xmx${HEAP_SIZE}M\"\n[ -n \"$JVM_ARGS\" ] && JAVA_CMD=\"$JAVA_CMD $JVM_ARGS\"\nJAVA_CMD=\"$JAVA_CMD -jar HytaleServer.jar\"\nJAVA_CMD=\"$JAVA_CMD --assets Assets.zip\"\nJAVA_CMD=\"$JAVA_CMD --bind 0.0.0.0:${HYTALE_PORT}\"\nJAVA_CMD=\"$JAVA_CMD --auth-mode ${AUTH_MODE}\"\nJAVA_CMD=\"$JAVA_CMD --disable-sentry\"\n[ -d \"universe\" ] && JAVA_CMD=\"$JAVA_CMD --universe universe\"\n[ \"${ENABLE_BACKUPS:-0}\" = \"1\" ] && JAVA_CMD=\"$JAVA_CMD --backup\"\n[ -n \"$BACKUP_DIR\" ] && JAVA_CMD=\"$JAVA_CMD --backup-dir $BACKUP_DIR\"\n[ -n \"$BACKUP_FREQUENCY\" ] && JAVA_CMD=\"$JAVA_CMD --backup-frequency $BACKUP_FREQUENCY\"\n[ \"${ALLOW_OP:-0}\" = \"1\" ] && JAVA_CMD=\"$JAVA_CMD --allow-op\"\n\nexec $JAVA_CMD\nSTARTSCRIPT\n\nchmod +x start.sh\necho \"Start script created with auto-update support.\"\n\n# ========================================\n# Step 1: Initial Download\n# ========================================\necho \"\"\necho \"=== Step 1: Initial F2P Server Download ===\"\n\ndownload_file() {\n    local url=\"$1\"\n    local dest=\"$2\"\n    local name=\"$3\"\n    local expected_mb=\"$4\"\n    \n    echo \"Downloading $name from $url\"\n    for attempt in 1 2 3; do\n        if curl -fL -# -o \"${dest}.tmp\" \"$url\" 2>&1; then\n            mv \"${dest}.tmp\" \"$dest\"\n            local size=$(stat -c%s \"$dest\" 2>/dev/null || stat -f%z \"$dest\" 2>/dev/null || echo 0)\n            local mb=$((size / 1024 / 1024))\n            echo \"$name downloaded (${mb} MB)\"\n            \n            # Save version\n            local version=$(curl -sI -L \"$url\" 2>/dev/null | tr -d '\\r' | grep -i \"^etag:\" | tail -1 | sed 's/^[^:]*: *//' | tr -d '\"')\n            if [ -n \"$version\" ]; then\n                echo \"$version\" > \"$VERSION_DIR/${name}.version\"\n            fi\n            return 0\n        fi\n        echo \"Attempt $attempt failed, retrying...\"\n        rm -f \"${dest}.tmp\"\n        sleep 2\n    done\n    return 1\n}\n\nif [ ! -f \"HytaleServer.jar\" ]; then\n    download_file \"${F2P_DOWNLOAD_BASE}/HytaleServer.jar\" \"HytaleServer.jar\" \"HytaleServer.jar\" \"80\" || exit 1\nelse\n    echo \"HytaleServer.jar exists, will check for updates on start\"\nfi\n\nif [ ! -f \"Assets.zip\" ]; then\n    echo \"Downloading Assets.zip (~3.3 GB) - this may take a while...\"\n    download_file \"${F2P_DOWNLOAD_BASE}/Assets.zip\" \"Assets.zip\" \"Assets.zip\" \"3300\" || exit 1\nelse\n    echo \"Assets.zip exists, will check for updates on start\"\nfi\n\n# ========================================\n# Step 2: Verify\n# ========================================\necho \"\"\necho \"=== Step 2: Verifying ===\"\n\nif unzip -l HytaleServer.jar 2>/dev/null | grep -q \"$INJECTED_CLASS\"; then\n    echo \"DualAuth classes found - patch verified!\"\nelse\n    echo \"WARNING: DualAuth classes not found!\"\nfi\n\necho \"\"\necho \"=== Installation Complete ===\"\necho \"Auto-update enabled: server will check for updates on each start\"\necho \"\"\n",
            "container": "ghcr.io/parkervcp/installers:debian",
            "entrypoint": "bash"
        }
    },
    "variables": [
        {
            "name": "F2P Download Base URL",
            "description": "Base URL for downloading server files.",
            "env_variable": "F2P_DOWNLOAD_BASE",
            "default_value": "https://download.sanasol.ws/download",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|url",
            "field_type": "text"
        },
        {
            "name": "Auth Domain",
            "description": "F2P authentication server domain (4-16 chars).",
            "env_variable": "AUTH_DOMAIN",
            "default_value": "auth.sanasol.ws",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|min:4|max:16",
            "field_type": "text"
        },
        {
            "name": "Auto Update",
            "description": "Check for server updates on each start (1=enabled, 0=disabled).",
            "env_variable": "AUTO_UPDATE",
            "default_value": "1",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|boolean",
            "field_type": "text"
        },
        {
            "name": "Server Port",
            "description": "UDP port for the game server.",
            "env_variable": "HYTALE_PORT",
            "default_value": "5520",
            "user_viewable": true,
            "user_editable": false,
            "rules": "required|integer|min:1024|max:65535",
            "field_type": "text"
        },
        {
            "name": "Memory Overhead",
            "description": "Memory reserved for JVM overhead in MB.",
            "env_variable": "MEMORY_OVERHEAD",
            "default_value": "256",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|min:0",
            "field_type": "text"
        },
        {
            "name": "Authentication Mode",
            "description": "Server authentication mode.",
            "env_variable": "AUTH_MODE",
            "default_value": "authenticated",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:authenticated,unauthenticated,singleplayer",
            "field_type": "text"
        },
        {
            "name": "JVM Arguments",
            "description": "Additional Java Virtual Machine arguments.",
            "env_variable": "JVM_ARGS",
            "default_value": "",
            "user_viewable": true,
            "user_editable": true,
            "rules": "nullable|string",
            "field_type": "text"
        },
        {
            "name": "Enable Backups",
            "description": "Enable automatic world backups.",
            "env_variable": "ENABLE_BACKUPS",
            "default_value": "0",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|boolean",
            "field_type": "text"
        },
        {
            "name": "Backup Directory",
            "description": "Directory for backups.",
            "env_variable": "BACKUP_DIR",
            "default_value": "backups",
            "user_viewable": true,
            "user_editable": true,
            "rules": "nullable|string|max:128",
            "field_type": "text"
        },
        {
            "name": "Backup Frequency",
            "description": "Backup frequency in minutes.",
            "env_variable": "BACKUP_FREQUENCY",
            "default_value": "30",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|min:1",
            "field_type": "text"
        },
        {
            "name": "Allow Self Operator",
            "description": "Allow players to use /op command.",
            "env_variable": "ALLOW_OP",
            "default_value": "1",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|boolean",
            "field_type": "text"
        }
    ]
}
